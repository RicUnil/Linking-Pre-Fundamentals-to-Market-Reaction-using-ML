"""
Company name to ticker symbol mapping utilities.

This module provides functions to map company names from the quarterly
earnings files to their corresponding ticker symbols for yfinance downloads.
"""

from __future__ import annotations

import logging
from typing import Dict, Optional

import pandas as pd


logger = logging.getLogger(__name__)


# Comprehensive ticker mapping for S&P 500 and major companies
# Expanded to include maximum coverage of companies in dataset
COMPANY_TO_TICKER = {
    # A
    "3M COMPANY": "MMM",
    "ABBOTT LABORATORIES": "ABT",
    "ABBVIE": "ABBV",
    "ABBVIE INC": "ABBV",
    "ACCENTURE PLC": "ACN",
    "ACTIVISION BLIZZARD": "ATVI",
    "ADOBE": "ADBE",
    "ADOBE (NAS)": "ADBE",
    "ADOBE INC": "ADBE",
    "ADVANCED MICRO": "AMD",
    "ADVANCED MICRO DEVICES": "AMD",
    "AES": "AES",
    "AES CORP": "AES",
    "AFLAC": "AFL",
    "AFLAC INC": "AFL",
    "AGILENT TECHNOLOGIES": "A",
    "AGILENT TECHS.": "A",
    "AIR PRDS.& CHEMS.": "APD",
    "AIR PRODUCTS & CHEMICALS": "APD",
    "AIRBNB": "ABNB",
    "AIRBNB A": "ABNB",
    "AKAMAI TECHNOLOGIES": "AKAM",
    "AKAMAI TECHS.": "AKAM",
    "ALBEMARLE": "ALB",
    "ALBEMARLE CORP": "ALB",
    "ALEXANDRIA REAL ESTATE EQUITIES REIT": "ARE",
    "ALIGN TECHNOLOGY": "ALGN",
    "ALIGN TECHNOLOGY INC": "ALGN",
    "ALLEGION": "ALLE",
    "ALLEGION PLC": "ALLE",
    "ALLIANT ENERGY": "LNT",
    "ALLIANT ENERGY (XSC)": "LNT",
    "ALLIANT ENERGY CORP": "LNT",
    "ALLSTATE": "ALL",
    "ALLSTATE CORP": "ALL",
    "ALLSTATE ORD SHS": "ALL",
    "ALPHABET": "GOOGL",
    "ALPHABET 'A'": "GOOGL",
    "ALPHABET 'C'": "GOOG",
    "ALPHABET INC": "GOOGL",
    "ALTRIA GROUP": "MO",
    "AMAZON": "AMZN",
    "AMAZON.COM": "AMZN",
    "AMAZON.COM INC": "AMZN",
    "AMCOR": "AMCR",
    "AMCOR PLC": "AMCR",
    "AMER.ELEC.PWR.": "AEP",
    "AMEREN": "AEE",
    "AMEREN CORPORATION": "AEE",
    "AMERICAN ELECTRIC": "AEP",
    "AMERICAN ELECTRIC POWER": "AEP",
    "AMERICAN EXPRESS": "AXP",
    "AMERICAN EXPRESS CO": "AXP",
    "AMERICAN INT'L GROUP": "AIG",
    "AMERICAN INTL.GP.": "AIG",
    "AMERICAN TOWER": "AMT",
    "AMERICAN TOWER CORP": "AMT",
    "AMERICAN WATER WORKS": "AWK",
    "AMERIPRISE FINL.": "AMP",
    "AMERIPRISE FINANCIAL": "AMP",
    "AMETEK": "AME",
    "AMETEK INC": "AME",
    "AMGEN": "AMGN",
    "AMGEN INC": "AMGN",
    "AMPHENOL": "APH",
    "AMPHENOL 'A'": "APH",
    "AMPHENOL CORP": "APH",
    "ANALOG DEVICES": "ADI",
    "ANALOG DEVICES, INC.": "ADI",
    "ANSYS": "ANSS",
    "AON": "AON",
    "AON CLASS A": "AON",
    "AON PLC": "AON",
    "APA": "APA",
    "APA CORP (US)": "APA",
    "APACHE": "APA",
    "APOLLO GLOB": "APO",
    "APOLLO GLOBAL MANAGEMENT": "APO",
    "APPLE": "AAPL",
    "APPLE INC": "AAPL",
    "APPLIED MATERIALS": "AMAT",
    "APPLIED MATS.": "AMAT",
    "APPLOVIN": "APP",
    "APPLOVIN A": "APP",
    "APTIV": "APTV",
    "APTIV PLC": "APTV",
    "ARCH CAP.GP.": "ACGL",
    "ARCH CAPITAL GROUP": "ACGL",
    "ARCHER DANIELS MIDL": "ADM",
    "ARCHER DANIELS MIDLAND": "ADM",
    "ARCHER-DANIELS-MIDLAND": "ADM",
    "ARISTA NETWORKS": "ANET",
    "ARISTA NETWORKS INC": "ANET",
    "ARTHUR J GALLAGHER": "AJG",
    "ARTHUR J. GALLAGHE": "AJG",
    "ASSURANT": "AIZ",
    "ASSURANT INC": "AIZ",
    "AT&T": "T",
    "AT&T INC": "T",
    "ATLASSIAN": "TEAM",
    "ATLASSIAN CORP": "TEAM",
    "ATMOS ENERGY": "ATO",
    "ATMOS ENERGY CORP": "ATO",
    "AUTODESK": "ADSK",
    "AUTOMATIC DATA PROC.": "ADP",
    "AUTOMATIC DATA PROCESSING": "ADP",
    "AUTOZONE": "AZO",
    "AVALONBAY": "AVB",
    "AVALONBAY COMMUNITIES": "AVB",
    "AVALONBAY COMMNS.": "AVB",
    "AVERY DENNISON": "AVY",
    "AVERY DENNISON CORP": "AVY",
    "AXON ENTERPRISE": "AXON",
    
    # B
    "BAKER HUGHES": "BKR",
    "BAKER HUGHES A": "BKR",
    "BAKER HUGHES CO": "BKR",
    "BALL": "BALL",
    "BALL CORPORATION": "BALL",
    "BANK OF AMERICA": "BAC",
    "BANK OF AMERICA CORP": "BAC",
    "BANK OF NEW YORK": "BK",
    "BANK OF NEW YORK MELLON": "BK",
    "BAXTER INTERNATIONAL": "BAX",
    "BAXTER INTL.": "BAX",
    "BECTON DICKINSON": "BDX",
    "BECTON, DICKINSON": "BDX",
    "BERKSHIRE HATHAWAY": "BRK.B",
    "BERKSHIRE HATHAWAY 'B'": "BRK.B",
    "BEST BUY": "BBY",
    "BEST BUY CO INC": "BBY",
    "BIO-TECHNE": "TECH",
    "BIO-TECHNE CORP": "TECH",
    "BIOGEN": "BIIB",
    "BLACKROCK": "BLK",
    "BLACKROCK INC": "BLK",
    "BLACKSTONE": "BX",
    "BLOCK": "SQ",
    "BLOCK A": "SQ",
    "BOEING": "BA",
    "BOOKING HOLDINGS": "BKNG",
    "BOSTON PROPERTIES": "BXP",
    "BOSTON PROPERTIES INC": "BXP",
    "BOSTON SCIENTIFIC": "BSX",
    "BRISTO": "BMY",
    "BRISTOL MYERS SQUIBB": "BMY",
    "BRISTOL-MYERS SQUIBB": "BMY",
    "BROADCOM": "AVGO",
    "BROADCOM INC": "AVGO",
    "BROADRIDGE FINANCIAL": "BR",
    "BROADRIDGE FINL.SLTN.": "BR",
    "BROWN & BROWN": "BRO",
    "BROWN-FORMAN": "BF.B",
    "BROWN-FORMAN 'B'": "BF.B",
    "BROWN-FORMAN CORP": "BF.B",
    "BUILDERS FIRSTSOURCE": "BLDR",
    "BUNGE": "BG",
    "BUNGE GLOBAL": "BG",
    "BUNGE GLOBAL SA": "BG",
    "BXP": "BXP",
    "BXP INC": "BXP",
    
    # C
    "CADENCE DESIGN": "CDNS",
    "CADENCE DESIGN SYS.": "CDNS",
    "CADENCE DESIGN SYST": "CDNS",
    "CADENCE DESIGN SYSTEMS": "CDNS",
    "CAMDEN PROPERTY": "CPT",
    "CAMDEN PROPERTY TST.": "CPT",
    "CAMPBELL'S CO": "CPB",
    "CAMPBELL SOUP": "CPB",
    "CAPITAL ONE": "COF",
    "CAPITAL ONE FIN'L": "COF",
    "CAPITAL ONE FINANCIAL": "COF",
    "CARDINAL HEALTH": "CAH",
    "CARMAX": "KMX",
    "CARNIVAL": "CCL",
    "CARNIVAL CORP": "CCL",
    "CARRIER GLOBAL": "CARR",
    "CATERPILLAR": "CAT",
    "CBRE GROUP": "CBRE",
    "CELANESE": "CE",
    "CENTENE": "CNC",
    "CENTERPOINT ENERGY": "CNP",
    "CERIDIAN HCM": "CDAY",
    "CF INDUSTRIES": "CF",
    "CHARLES SCHWAB": "SCHW",
    "CHARTER COMM": "CHTR",
    "CHARTER COMMUNICATIONS": "CHTR",
    "CHEVRON": "CVX",
    "CHIPOTLE": "CMG",
    "CHIPOTLE MEXICAN GRILL": "CMG",
    "CHUBB": "CB",
    "CHURCH & DWIGHT": "CHD",
    "CIGNA": "CI",
    "CINCINNATI FINANCIAL": "CINF",
    "CINTAS": "CTAS",
    "CISCO": "CSCO",
    "CISCO SYSTEMS": "CSCO",
    "CITIGROUP": "C",
    "CITIZENS FINANCIAL": "CFG",
    "CLOROX": "CLX",
    "CLOUDFLARE": "NET",
    "CME GROUP": "CME",
    "CMS ENERGY": "CMS",
    "COCA-COLA": "KO",
    "COGNIZANT": "CTSH",
    "COGNIZANT TECH.SOLUTIONS": "CTSH",
    "COLGATE-PALMOLIVE": "CL",
    "COMCAST": "CMCSA",
    "COMERICA": "CMA",
    "CONAGRA BRANDS": "CAG",
    "CONOCOPHILLIPS": "COP",
    "CONSOLIDATED EDISON": "ED",
    "CONSTELLATION BRANDS": "STZ",
    "CONSTELLATION ENERGY": "CEG",
    "COOPER": "COO",
    "COPART": "CPRT",
    "CORNING": "GLW",
    "CORTEVA": "CTVA",
    "COSTCO": "COST",
    "COSTCO WHOLESALE": "COST",
    "COTERRA ENERGY": "CTRA",
    "CROWDSTRIKE": "CRWD",
    "CROWDSTRIKE HOLDINGS": "CRWD",
    "CROWN CASTLE": "CCI",
    "CSX": "CSX",
    "CUMMINS": "CMI",
    "CVS": "CVS",
    "CVS HEALTH": "CVS",
    
    # D
    "DANAHER": "DHR",
    "DARDEN RESTAURANTS": "DRI",
    "DATADOG": "DDOG",
    "DAVITA": "DVA",
    "DEERE": "DE",
    "DELTA AIR LINES": "DAL",
    "DENTSPLY SIRONA": "XRAY",
    "DEVON ENERGY": "DVN",
    "DIAMONDBACK ENERGY": "FANG",
    "DIGITAL REALTY": "DLR",
    "DIGITAL REALTY TRUST": "DLR",
    "DISCOVER FINANCIAL": "DFS",
    "DISNEY": "DIS",
    "DISNEY (WALT)": "DIS",
    "WALT DISNEY": "DIS",
    "DOLLAR GENERAL": "DG",
    "DOLLAR GENERAL CORP": "DG",
    "DOLLAR TREE": "DLTR",
    "DOLLAR TREE INC": "DLTR",
    "DOMINION ENERGY": "D",
    "DOMINO'S PIZZA": "DPZ",
    "DOMINOS PIZZA": "DPZ",
    "DOVER": "DOV",
    "DOW": "DOW",
    "DR HORTON": "DHI",
    "DTE ENERGY": "DTE",
    "DUKE ENERGY": "DUK",
    "DUPONT": "DD",
    
    # E
    "EASTMAN CHEMICAL": "EMN",
    "EATON": "ETN",
    "EBAY": "EBAY",
    "ECOLAB": "ECL",
    "EDISON INTERNATIONAL": "EIX",
    "EDWARDS LIFESCIENCES": "EW",
    "ELECTRONIC ARTS": "EA",
    "ELI LILLY": "LLY",
    "EMERSON ELECTRIC": "EMR",
    "ENPHASE ENERGY": "ENPH",
    "ENTERGY": "ETR",
    "EOG RESOURCES": "EOG",
    "EPAM SYSTEMS": "EPAM",
    "EQT": "EQT",
    "EQUIFAX": "EFX",
    "EQUINIX": "EQIX",
    "EQUITY RESIDENTIAL": "EQR",
    "ESSEX PROPERTY": "ESS",
    "ESTEE LAUDER": "EL",
    "ESTEE LAUDER COMPANIES": "EL",
    "EVEREST RE": "RE",
    "EVERSOURCE ENERGY": "ES",
    "EXELON": "EXC",
    "EXPEDIA": "EXPE",
    "EXPEDITORS INTERNATIONAL": "EXPD",
    "EXTRA SPACE STORAGE": "EXR",
    "EXXON MOBIL": "XOM",
    
    # F
    "F5": "FFIV",
    "FACEBOOK": "META",
    "FACTSET": "FDS",
    "FAIR ISAAC": "FICO",
    "FASTENAL": "FAST",
    "FEDERAL REALTY": "FRT",
    "FEDEX": "FDX",
    "FIDELITY NATIONAL": "FIS",
    "FIFTH THIRD BANCORP": "FITB",
    "FIRST SOLAR": "FSLR",
    "FIRSTENERGY": "FE",
    "FISERV": "FISV",
    "FLEETCOR": "FLT",
    "FORD MOTOR": "F",
    "FORTINET": "FTNT",
    "FORTIVE": "FTV",
    "FOX": "FOX",
    "FRANKLIN RESOURCES": "BEN",
    "FREEPORT-MCMORAN": "FCX",
    
    # G
    "GARMIN": "GRMN",
    "GARTNER": "IT",
    "GENERAL DYNAMICS": "GD",
    "GENERAL ELECTRIC": "GE",
    "GENERAL ELECTRIC CO": "GE",
    "GENERAL MILLS": "GIS",
    "GENERAL MOTORS": "GM",
    "GENERAL MOTORS CO": "GM",
    "GENUINE PARTS": "GPC",
    "GILEAD SCIENCES": "GILD",
    "GLOBE LIFE": "GL",
    "GOLDMAN SACHS": "GS",
    "GOLDMAN SACHS GROUP": "GS",
    "GOOGLE": "GOOGL",
    
    # H
    "HALLIBURTON": "HAL",
    "HARTFORD FINANCIAL": "HIG",
    "HASBRO": "HAS",
    "HCA HEALTHCARE": "HCA",
    "HEALTHPEAK": "PEAK",
    "HENRY SCHEIN": "HSIC",
    "HERSHEY": "HSY",
    "HESS": "HES",
    "HEWLETT PACKARD ENTERPRISE": "HPE",
    "HILTON WORLDWIDE": "HLT",
    "HOME DEPOT": "HD",
    "HOME DEPOT INC": "HD",
    "HONEYWELL": "HON",
    "HONEYWELL INTERNATIONAL": "HON",
    "HORMEL FOODS": "HRL",
    "HOST HOTELS": "HST",
    "HOWMET AEROSPACE": "HWM",
    "HP": "HPQ",
    "HUBSPOT": "HUBS",
    "HUMANA": "HUM",
    "HUNTINGTON BANCSHARES": "HBAN",
    
    # I
    "IBM": "IBM",
    "IDEXX LABORATORIES": "IDXX",
    "ILLINOIS TOOL WORKS": "ITW",
    "ILLUMINA": "ILMN",
    "INCYTE": "INCY",
    "INGERSOLL RAND": "IR",
    "INTEL": "INTC",
    "INT'L BUSINESS MACHS": "IBM",
    "INTERNATIONAL BUS.MCHS.": "IBM",
    "INTERNATIONAL BUSINESS MACHINES": "IBM",
    "INTERCONTINENTAL EXCHANGE": "ICE",
    "INTERNATIONAL FLAVORS": "IFF",
    "INTERNATIONAL PAPER": "IP",
    "INTERPUBLIC GROUP": "IPG",
    "INTUIT": "INTU",
    "INTUITIVE SURGICAL": "ISRG",
    "INVESCO": "IVZ",
    "INVITATION HOMES": "INVH",
    "IQVIA": "IQV",
    "IRON MOUNTAIN": "IRM",
    
    # J
    "JACOBS SOLUTIONS": "J",
    "JM SMUCKER": "SJM",
    "JOHNSON & JOHNSON": "JNJ",
    "JOHNSON AND JOHNSON": "JNJ",
    "JOHNSON CONTROLS": "JCI",
    "JPMORGAN CHASE": "JPM",
    "JPMORGAN CHASE & CO": "JPM",
    "JUNIPER NETWORKS": "JNPR",
    
    # K
    "KELLOGG": "K",
    "KEYCORP": "KEY",
    "KEYSIGHT": "KEYS",
    "KIMBERLY-CLARK": "KMB",
    "KIMCO REALTY": "KIM",
    "KINDER MORGAN": "KMI",
    "KLA": "KLAC",
    "KRAFT HEINZ": "KHC",
    "KROGER": "KR",
    
    # L
    "L3HARRIS": "LHX",
    "LAM RESEARCH": "LRCX",
    "LAMB WESTON": "LW",
    "LAS VEGAS SANDS": "LVS",
    "LENNAR": "LEN",
    "LINDE": "LIN",
    "LINDE PLC": "LIN",
    "LIVE NATION": "LYV",
    "LOCKHEED MARTIN": "LMT",
    "LOEWS": "L",
    "LOWE'S": "LOW",
    "LOWES": "LOW",
    "LULULEMON": "LULU",
    "LYONDELLBASELL": "LYB",
    
    # M
    "M&T BANK": "MTB",
    "MARATHON OIL": "MRO",
    "MARATHON PETROLEUM": "MPC",
    "MARRIOTT INTERNATIONAL": "MAR",
    "MARSH & MCLENNAN": "MMC",
    "MARTIN MARIETTA": "MLM",
    "MASCO": "MAS",
    "MASTERCARD": "MA",
    "MATCH GROUP": "MTCH",
    "MCCORMICK": "MKC",
    "MCDONALD'S": "MCD",
    "MCDONALDS": "MCD",
    "MCKESSON": "MCK",
    "MEDTRONIC": "MDT",
    "MERCK": "MRK",
    "META PLATFORMS": "META",
    "META PLATFORMS INC": "META",
    "METLIFE": "MET",
    "METTLER-TOLEDO": "MTD",
    "MGM RESORTS": "MGM",
    "MICROCHIP TECHNOLOGY": "MCHP",
    "MICRON TECHNOLOGY": "MU",
    "MICROSOFT": "MSFT",
    "MID-AMERICA APARTMENT": "MAA",
    "MODERNA": "MRNA",
    "MOLINA HEALTHCARE": "MOH",
    "MOLSON COORS": "TAP",
    "MONDELEZ": "MDLZ",
    "MONDELEZ INTERNATIONAL": "MDLZ",
    "MONGODB": "MDB",
    "MONSTER BEVERAGE": "MNST",
    "MOODY'S": "MCO",
    "MORGAN STANLEY": "MS",
    "MORGAN STANLEY DEAN WITTER": "MS",
    "MOSAIC": "MOS",
    "MOTOROLA SOLUTIONS": "MSI",
    "MSCI": "MSCI",
    
    # N
    "NASDAQ": "NDAQ",
    "NETFLIX": "NFLX",
    "NEWMONT": "NEM",
    "NEWS CORP": "NWSA",
    "NEXTERA ENERGY": "NEE",
    "NIKE": "NKE",
    "NRG ENERGY": "NRG",
    "NORFOLK SOUTHERN": "NSC",
    "NORTHERN TRUST": "NTRS",
    "NORTHROP GRUMMAN": "NOC",
    "NORWEGIAN CRUISE": "NCLH",
    "NVR": "NVR",
    "NVIDIA": "NVDA",
    
    # O
    "OCCIDENTAL PETROLEUM": "OXY",
    "OLD DOMINION": "ODFL",
    "OMNICOM": "OMC",
    "ON SEMICONDUCTOR": "ON",
    "ONEOK": "OKE",
    "ORACLE": "ORCL",
    "OREILLY AUTOMOTIVE": "ORLY",
    "OTIS WORLDWIDE": "OTIS",
    
    # P
    "PACKAGING CORP": "PKG",
    "PALO ALTO NETWORKS": "PANW",
    "PARAMOUNT GLOBAL": "PARA",
    "PARKER-HANNIFIN": "PH",
    "PAYCHEX": "PAYX",
    "PAYCOM": "PAYC",
    "PAYPAL": "PYPL",
    "PAYPAL HOLDINGS": "PYPL",
    "PENTAIR": "PNR",
    "PEPSICO": "PEP",
    "PFIZER": "PFE",
    "PG&E": "PCG",
    "PHILIP MORRIS INTL": "PM",
    "PHILIP MORRIS INTERNATIONAL": "PM",
    "PHILLIPS 66": "PSX",
    "PINNACLE WEST": "PNW",
    "PINTEREST": "PINS",
    "PNC FINANCIAL": "PNC",
    "POOL": "POOL",
    "PPG INDUSTRIES": "PPG",
    "PPL": "PPL",
    "PRINCIPAL FINANCIAL": "PFG",
    "PROCTER & GAMBLE": "PG",
    "PROCTER AND GAMBLE": "PG",
    "PROGRESSIVE": "PGR",
    "PROLOGIS": "PLD",
    "PRUDENTIAL FINANCIAL": "PRU",
    "PUBLIC SERVICE ENTERPRISE": "PEG",
    "PUBLIC STORAGE": "PSA",
    "PULTEGROUP": "PHM",
    
    # Q
    "QORVO": "QRVO",
    "QUALCOMM": "QCOM",
    "QUANTA SERVICES": "PWR",
    
    # R
    "RALPH LAUREN": "RL",
    "RAYMOND JAMES": "RJF",
    "RAYTHEON": "RTX",
    "REALTY INCOME": "O",
    "REGENCY CENTERS": "REG",
    "REGENERON": "REGN",
    "REGENERON PHARMACEUTICALS": "REGN",
    "REGIONS FINANCIAL": "RF",
    "REPUBLIC SERVICES": "RSG",
    "RESMED": "RMD",
    "REVVITY": "RVTY",
    "ROBERT HALF": "RHI",
    "ROCKWELL AUTOMATION": "ROK",
    "ROLLINS": "ROL",
    "ROPER TECHNOLOGIES": "ROP",
    "ROSS STORES": "ROST",
    "ROSS STORES INC": "ROST",
    "ROYAL CARIBBEAN": "RCL",
    "RPM INTERNATIONAL": "RPM",
    "RTX": "RTX",
    
    # S
    "SALESFORCE": "CRM",
    "SALESFORCE.COM": "CRM",
    "SBA COMMUNICATIONS": "SBAC",
    "SCHLUMBERGER": "SLB",
    "SCHLUMBERGER LTD": "SLB",
    "SEAGATE TECHNOLOGY": "STX",
    "SEMPRA ENERGY": "SRE",
    "SERVICENOW": "NOW",
    "SHERWIN-WILLIAMS": "SHW",
    "SIMON PROPERTY": "SPG",
    "SKYWORKS SOLUTIONS": "SWKS",
    "SNAP": "SNAP",
    "SNOWFLAKE": "SNOW",
    "SOUTHERN": "SO",
    "SOUTHWEST AIRLINES": "LUV",
    "SPOTIFY": "SPOT",
    "SQUARE": "SQ",
    "STARBUCKS": "SBUX",
    "STARBUCKS CORP": "SBUX",
    "STATE STREET": "STT",
    "STERIS": "STE",
    "STRYKER": "SYK",
    "SUN COMMUNITIES": "SUI",
    "SYNCHRONY FINANCIAL": "SYF",
    "SYNOPSYS": "SNPS",
    "SYNOPSYS INC": "SNPS",
    "SYSCO": "SYY",
    
    # T
    "T-MOBILE": "TMUS",
    "T-MOBILE US": "TMUS",
    "T. ROWE PRICE": "TROW",
    "TAKE-TWO INTERACTIVE": "TTWO",
    "TAPESTRY": "TPR",
    "TARGET": "TGT",
    "TARGET CORP": "TGT",
    "TE CONNECTIVITY": "TEL",
    "TESLA": "TSLA",
    "TESLA INC": "TSLA",
    "TEXAS INSTRUMENTS": "TXN",
    "TEXAS INSTRUMENTS INC": "TXN",
    "TEXTRON": "TXT",
    "THERMO FISHER": "TMO",
    "THERMO FISHER SCIENTIFIC": "TMO",
    "TJX": "TJX",
    "TRANE TECHNOLOGIES": "TT",
    "TRANSDIGM": "TDG",
    "TRAVELERS": "TRV",
    "TRIMBLE": "TRMB",
    "TRUIST FINANCIAL": "TFC",
    "TYLER TECHNOLOGIES": "TYL",
    "TYSON FOODS": "TSN",
    
    # U
    "UBER": "UBER",
    "UBER TECHNOLOGIES": "UBER",
    "UDR": "UDR",
    "ULTA BEAUTY": "ULTA",
    "UNION PACIFIC": "UNP",
    "UNION PACIFIC CORP": "UNP",
    "UNITED AIRLINES": "UAL",
    "UNITED PARCEL SERVICE": "UPS",
    "UPS": "UPS",
    "UNITED RENTALS": "URI",
    "UNITEDHEALTH": "UNH",
    "UNITEDHEALTH GROUP": "UNH",
    "UNIVERSAL HEALTH": "UHS",
    "UNUM GROUP": "UNM",
    "US BANCORP": "USB",
    "VALERO ENERGY": "VLO",
    
    # V
    "VENTAS": "VTR",
    "VERISIGN": "VRSN",
    "VERISK": "VRSK",
    "VERIZON": "VZ",
    "VERTEX": "VRTX",
    "VERTEX PHARMACEUTICALS": "VRTX",
    "VF CORP": "VFC",
    "VIATRIS": "VTRS",
    "VISA": "V",
    "VORNADO REALTY": "VNO",
    "VULCAN MATERIALS": "VMC",
    
    # W
    "WABTEC": "WAB",
    "WALGREENS BOOTS": "WBA",
    "WALMART": "WMT",
    "WALMART INC": "WMT",
    "WARNER BROS DISCOVERY": "WBD",
    "WASTE MANAGEMENT": "WM",
    "WATERS": "WAT",
    "WELLTOWER": "WELL",
    "WELLS FARGO": "WFC",
    "WELLS FARGO & CO": "WFC",
    "WEST PHARMACEUTICAL": "WST",
    "WESTERN DIGITAL": "WDC",
    "WESTROCK": "WRK",
    "WEYERHAEUSER": "WY",
    "WHIRLPOOL": "WHR",
    "WILLIAMS": "WMB",
    "WYNN RESORTS": "WYNN",
    
    # X
    "XCEL ENERGY": "XEL",
    "XYLEM": "XYL",
    
    # Y
    "YUM! BRANDS": "YUM",
    "YUM BRANDS": "YUM",
    
    # Z
    "ZEBRA TECHNOLOGIES": "ZBRA",
    "ZILLOW": "Z",
    "ZIMMER BIOMET": "ZBH",
    "ZIONS BANCORP": "ZION",
    "ZOOM VIDEO": "ZM",
    "ZOETIS": "ZTS",
    "ZOETIS INC": "ZTS",
    
    # Additional mappings - Extended coverage
    "CAPITAL ONE FINL.": "COF",
    "CATERPILLAR INC": "CAT",
    "CBOE GLOBAL": "CBOE",
    "CBOE GLOBAL MARKETS": "CBOE",
    "CBOE GLOBAL MARKETS(BTS)": "CBOE",
    "CBRE GROUP CLASS A": "CBRE",
    "CDW": "CDW",
    "CDW CORP": "CDW",
    "CENCORA": "COR",
    "CENCORA INC": "COR",
    "CENTENE CORP": "CNC",
    "CENTERPOINT EN.": "CNP",
    "CF IND HLDGS INC": "CF",
    "CF INDUSTRIES HDG.": "CF",
    "CH ROBINSO": "CHRW",
    "CH ROBINSON WWD.": "CHRW",
    "CHARLES SCHWAB CORP": "SCHW",
    "CHARTER COMMS.CL.A": "CHTR",
    "CHARTER COMMU": "CHTR",
    "CHAS.RVR.LABS.INTL.": "CRL",
    "CHARLES RIVER LABORATORIES": "CRL",
    "CHEVRON CORP": "CVX",
    "CHIPOTLE MEXN.GRILL": "CMG",
    "CHURCH & DWIGHT CO": "CHD",
    "CHURCH & DWIGHT CO.": "CHD",
    "CIGNA GROUP": "CI",
    "CINCINNATI FINL CORP": "CINF",
    "CINCINNATI FINL.": "CINF",
    "CINTAS CORP": "CTAS",
    "CITIGROUP INC": "C",
    "CITIZENS FINANCIAL GROUP": "CFG",
    "CME GROUP INC": "CME",
    "CMS ENERGY CORP": "CMS",
    "COCA COLA": "KO",
    "COGNIZANT TECH.SLTN.'A'": "CTSH",
    "COGNIZANT TECHNOLOGY": "CTSH",
    "COINBASE GLOBAL": "COIN",
    "COINBASE GLOBAL A": "COIN",
    "COINBASE GLOBAL INC": "COIN",
    "COLGATE-PALM.": "CL",
    "COLGATE-PALMOLIVE CO": "CL",
    "COMCAST A": "CMCSA",
    "CONAGRA BRANDS INC": "CAG",
    "CONSTELLATION BRANDS 'A'": "STZ",
    "COOPER COS.": "COO",
    "COPART INC": "CPRT",
    "CORNING INCORPORATED": "GLW",
    "CORPAY": "CPAY",
    "CORPAY INC": "CPAY",
    "CORTEVA INC": "CTVA",
    "COSTAR GP.": "CSGP",
    "COSTAR GROUP": "CSGP",
    "COTERRA ENERGY INC": "CTRA",
    "CROWDSTRIKE HOLD": "CRWD",
    "CROWDSTRIKE HOLDINGS A": "CRWD",
    "CSX CORP": "CSX",
    "CUMMINS INC": "CMI",
    "CVS HEALTH CORP": "CVS",
    "D R HORTON": "DHI",
    "DATADOG A": "DDOG",
    "DATADOG INC": "DDOG",
    "DAYFORCE": "DAY",
    "DECKERS OUTDOOR": "DECK",
    "DEERE & CO": "DE",
    "DELL TECH": "DELL",
    "DELL TECHNOLOGIES": "DELL",
    "DELL TECHNOLOGIES C": "DELL",
    "DELTA AIR LINES, INC": "DAL",
    "DEVON ENERGY CORP": "DVN",
    "DEXCOM": "DXCM",
    "DEXCOM INC": "DXCM",
    "DIAMONDBACK": "FANG",
    "DIGITAL REALTY TST.": "DLR",
    "DOLLAR TREE, INC": "DLTR",
    "DOMINION ENERGY INC": "D",
    "DOMINO' S PIZZA, INC": "DPZ",
    "DOORDASH": "DASH",
    "DOORDASH A": "DASH",
    "DOORDASH INC": "DASH",
    "DOVER CORP": "DOV",
    "DOW INC": "DOW",
    "DOW ORD SHS": "DOW",
    "DTE ENERGY CO": "DTE",
    "DUKE ENERGY CORP": "DUK",
    "DUPONT DE NEMOURS": "DD",
    "EATON CORP PLC": "ETN",
    "EBAY INC.": "EBAY",
    "EDISON INTL.": "EIX",
    "ELECTRONIC ARTS, INC": "EA",
    "ELEVANCE HEALTH": "ELV",
    "EMCOR GROUP": "EME",
    "EMERSON ELECTRIC CO.": "EMR",
    "EOG RES.": "EOG",
    "EPAM SYSTE": "EPAM",
    "EQT CORPORATION": "EQT",
    "EQUIFAX INC.": "EFX",
    "EQUINIX REIT": "EQIX",
    "EQUINIX, INC.": "EQIX",
    "EQUITY RESD.TST.PROPS. SHBI": "EQR",
    "ERIE INDEMNITY": "ERIE",
    "ERIE INDEMNITY 'A'": "ERIE",
    "ESSEX PROPERTY TST.": "ESS",
    "ESTEE LAUDER CO": "EL",
    "ESTEE LAUDER COS.'A'": "EL",
    "EVEREST GROUP": "EG",
    "EVEREST GROUP LTD": "EG",
    "EVERGY": "EVRG",
    "EVERGY INC": "EVRG",
    "EXPAND ENERGY": "EXE",
    "EXPAND ENERGY CORP": "EXE",
    "EXPEDIA GROUP": "EXPE",
    "EXPEDIA GROUP INC": "EXPE",
    "EXPEDITORS INTL WASH": "EXPD",
    "EXPEDITORS INTL.OF WASH. A": "EXPD",
    "EXTRA SPACE STRG.": "EXR",
    "EXXON MOBIL CORP": "XOM",
    "FACTSET RESEARCH SYS": "FDS",
    "FACTSET RESEARCH SYS.": "FDS",
    "FAIR ISAAC CORP.": "FICO",
    "FEDERAL REALTY INV.TST.": "FRT",
    "FEDERAL REALTY INVST": "FRT",
    "FEDEX CORP": "FDX",
    "FIDELITY NAT.INFO.SVS.": "FIS",
    "FIDELITY NATNL INF": "FIS",
    "FIRST SOLAR, INC.": "FSLR",
    "FISERV INC": "FISV",
    "FORD MOTOR COMPANY": "F",
    "FORTINET INC": "FTNT",
    "FORTIVE CORP": "FTV",
    "FOX A": "FOXA",
    "FOX B": "FOX",
    "FOX CORP": "FOX",
    "FREEPOR": "FCX",
    "GARMIN LTD.": "GRMN",
    "GARTNER 'A'": "IT",
    "GARTNER INC": "IT",
    "GE AEROSPACE": "GE",
    "GE HEALTHCARE": "GEHC",
    "GE HEALTHCARE TECHNOLOGIES": "GEHC",
    "GE VERNOVA": "GEV",
    "GEN DIGITAL": "GEN",
    "GEN DIGITAL INC": "GEN",
    "GENERAC HOLDINGS": "GNRC",
    "GILEAD SCIENCES, INC": "GILD",
    "GLOBAL PAYMENTS": "GPN",
    "GLOBE LIFE INC": "GL",
    "GODADDY": "GDDY",
    "GODADDY CL.A": "GDDY",
    "GOLDMAN SACHS GP.": "GS",
    "HALLIBURTON COMPANY": "HAL",
    "HARTFORD INSURANCE": "HIG",
    "HARTFORD INSURANCE GROUP": "HIG",
    "HASBRO INC": "HAS",
    "HEALTHPEAK PROPERTIES": "DOC",
    "HENRY, (JACK) & ASSC": "JKHY",
    "JACK HENRY": "JKHY",
    "HERSHEY CO": "HSY",
    "HESS CORP": "HES",
    "HEWLETT PACKARD": "HPQ",
    "HILTON WORLDWIDE HOLDINGS": "HLT",
    "HOLOGIC": "HOLX",
    "HOME DEPOT INC.": "HD",
    "HONEYWELL INTL.": "HON",
    "HORMEL FOODS CORP": "HRL",
    "HOST HOTELS & RESORTS": "HST",
    "HOWMET AEROSPACE CORP": "HWM",
    "HUBSPOT INC": "HUBS",
    "HUMANA INC": "HUM",
    "HUNTINGTON BANCSHARES INC": "HBAN",
    "HUNTINGTON INGALLS": "HII",
    "IDEXX LABS.": "IDXX",
    "ILLINOIS TOOL WKS.": "ITW",
    "ILLUMINA INC": "ILMN",
    "INCYTE CORP": "INCY",
    "INGERSOLL RAND INC": "IR",
    "INSULET": "PODD",
    "INSULET CORP": "PODD",
    "INTEL CORP": "INTC",
    "INTERCONTINENTAL EXCH.": "ICE",
    "INTERNATIONAL FLAVORS & FRAGRANCES": "IFF",
    "INTERNATIONAL PAPER CO": "IP",
    "INTERPUBLIC GP.OF COS.": "IPG",
    "INTUIT INC": "INTU",
    "INTUITIVE SURGICAL INC": "ISRG",
    "INVESCO LTD": "IVZ",
    "INVITATION HOMES INC": "INVH",
    "IQVIA HOLDINGS": "IQV",
    "IRON MOUNTAIN INC": "IRM",
    "JACOBS ENGINEERING": "J",
    "JOHNSON & JOHNSON ORD": "JNJ",
    "JOHNSON CONTROLS INTL": "JCI",
    "JPMORGAN CHASE & CO.": "JPM",
    "JUNIPER NETWORKS INC": "JNPR",
    "KELLANOVA": "K",
    "KEYCORP ORD": "KEY",
    "KEYSIGHT TECHNOLOGIES": "KEYS",
    "KIMBERLY-CLARK CORP": "KMB",
    "KIMCO REALTY CORP": "KIM",
    "KINDER MORGAN INC": "KMI",
    "KLA CORP": "KLAC",
    "KRAFT HEINZ CO": "KHC",
    "KROGER CO": "KR",
    "L3HARRIS TECHNOLOGIES": "LHX",
    "LAM RESEARCH CORP": "LRCX",
    "LAMB WESTON HOLDINGS": "LW",
    "LAS VEGAS SANDS CORP": "LVS",
    "LENNAR CORP": "LEN",
    "LIVE NATION ENTERTAINMENT": "LYV",
    "LOCKHEED MARTIN CORP": "LMT",
    "LOEWS CORP": "L",
    "LOWE'S COS.": "LOW",
    "LULULEMON ATHLETICA": "LULU",
    "LYONDELLBASELL INDUSTRIES": "LYB",
    "M&T BANK CORP": "MTB",
    "MARATHON OIL CORP": "MRO",
    "MARATHON PETROLEUM CORP": "MPC",
    "MARRIOTT INTL.": "MAR",
    "MARSH & MCLENNAN COS.": "MMC",
    "MARTIN MARIETTA MATERIALS": "MLM",
    "MASCO CORP": "MAS",
    "MASTERCARD INC": "MA",
    "MATCH GROUP INC": "MTCH",
    "MCCORMICK & CO": "MKC",
    "MCDONALD'S CORP": "MCD",
    "MCKESSON CORP": "MCK",
    "MEDTRONIC PLC": "MDT",
    "MERCK & CO": "MRK",
    "METLIFE INC": "MET",
    "METTLER-TOLEDO INTERNATIONAL": "MTD",
    "MGM RESORTS INTERNATIONAL": "MGM",
    "MICROCHIP TECHNOLOGY INC": "MCHP",
    "MICRON TECHNOLOGY INC": "MU",
    "MICROSOFT CORP": "MSFT",
    "MID-AMERICA APARTMENT COMMUNITIES": "MAA",
    "MODERNA INC": "MRNA",
    "MOLINA HEALTHCARE INC": "MOH",
    "MOLSON COORS BEVERAGE": "TAP",
    "MONGODB INC": "MDB",
    "MONSTER BEVERAGE CORP": "MNST",
    "MOODY'S CORP": "MCO",
    "MORGAN STANLEY ORD": "MS",
    "MOSAIC CO": "MOS",
    "MOTOROLA SOLUTIONS INC": "MSI",
    "MSCI INC": "MSCI",
    "NASDAQ INC": "NDAQ",
    "NETFLIX INC": "NFLX",
    "NEWMONT CORP": "NEM",
    "NEWS CORP A": "NWSA",
    "NEWS CORP B": "NWS",
    "NEXTERA ENERGY INC": "NEE",
    "NIKE INC": "NKE",
    "NRG ENERGY INC": "NRG",
    "NORFOLK SOUTHERN CORP": "NSC",
    "NORTHERN TRUST CORP": "NTRS",
    "NORTHROP GRUMMAN CORP": "NOC",
    "NORWEGIAN CRUISE LINE": "NCLH",
    "NVR INC": "NVR",
    "NVIDIA CORP": "NVDA",
    "OCCIDENTAL PETROLEUM CORP": "OXY",
    "OLD DOMINION FREIGHT": "ODFL",
    "OMNICOM GROUP": "OMC",
    "ON SEMICONDUCTOR CORP": "ON",
    "ONEOK INC": "OKE",
    "ORACLE CORP": "ORCL",
    "OREILLY AUTOMOTIVE INC": "ORLY",
    "OTIS WORLDWIDE CORP": "OTIS",
    "PACKAGING CORP OF AMERICA": "PKG",
    "PALO ALTO NETWORKS INC": "PANW",
    "PARAMOUNT GLOBAL B": "PARA",
    "PARKER-HANNIFIN CORP": "PH",
    "PAYCHEX INC": "PAYX",
    "PAYCOM SOFTWARE": "PAYC",
    "PAYPAL HOLDINGS INC": "PYPL",
    "PENTAIR PLC": "PNR",
    "PEPSICO INC": "PEP",
    "PFIZER INC": "PFE",
    "PG&E CORP": "PCG",
    "PHILIP MORRIS INTL INC": "PM",
    "PHILLIPS 66 ORD": "PSX",
    "PINNACLE WEST CAPITAL": "PNW",
    "PINTEREST INC": "PINS",
    "PNC FINANCIAL SERVICES": "PNC",
    "POOL CORP": "POOL",
    "PPG INDUSTRIES INC": "PPG",
    "PPL CORP": "PPL",
    "PRINCIPAL FINANCIAL GROUP": "PFG",
    "PROCTER & GAMBLE CO": "PG",
    "PROGRESSIVE CORP": "PGR",
    "PROLOGIS INC": "PLD",
    "PRUDENTIAL FINANCIAL INC": "PRU",
    "PUBLIC SERVICE ENTERPRISE GROUP": "PEG",
    "PUBLIC STORAGE INC": "PSA",
    "PULTEGROUP INC": "PHM",
    "QORVO INC": "QRVO",
    "QUALCOMM INC": "QCOM",
    "QUANTA SERVICES INC": "PWR",
    "RALPH LAUREN CORP": "RL",
    "RAYMOND JAMES FINANCIAL": "RJF",
    "REALTY INCOME CORP": "O",
    "REGENCY CENTERS CORP": "REG",
    "REGENERON PHARMACEUTICALS INC": "REGN",
    "REGIONS FINANCIAL CORP": "RF",
    "REPUBLIC SERVICES INC": "RSG",
    "RESMED INC": "RMD",
    "REVVITY INC": "RVTY",
    "ROBERT HALF INC": "RHI",
    "ROCKWELL AUTOMATION": "ROK",
    "ROLLINS INC": "ROL",
    "ROPER TECHNOLOGIES INC": "ROP",
    "ROSS STORES INC.": "ROST",
    "ROYAL CARIBBEAN CRUISES": "RCL",
    "RPM INTERNATIONAL INC": "RPM",
    "RTX CORP": "RTX",
    "SALESFORCE INC": "CRM",
    "SBA COMMUNICATIONS CORP": "SBAC",
    "SCHLUMBERGER NV": "SLB",
    "SEAGATE TECHNOLOGY HOLDINGS": "STX",
    "SEMPRA": "SRE",
    "SERVICENOW INC": "NOW",
    "SHERWIN-WILLIAMS CO": "SHW",
    "SIMON PROPERTY GROUP": "SPG",
    "SKYWORKS SOLUTIONS INC": "SWKS",
    "SNAP INC": "SNAP",
    "SNOWFLAKE INC": "SNOW",
    "SOUTHERN CO": "SO",
    "SOUTHWEST AIRLINES CO": "LUV",
    "SPOTIFY TECHNOLOGY": "SPOT",
    "STARBUCKS CORP.": "SBUX",
    "STATE STREET CORP": "STT",
    "STERIS PLC": "STE",
    "STRYKER CORP": "SYK",
    "SUN COMMUNITIES INC": "SUI",
    "SYNCHRONY FINANCIAL ORD": "SYF",
    "SYNOPSYS INC.": "SNPS",
    "SYSCO CORP": "SYY",
    "T-MOBILE US INC": "TMUS",
    "T. ROWE PRICE GROUP": "TROW",
    "TAKE-TWO INTERACTIVE SOFTWARE": "TTWO",
    "TAPESTRY INC": "TPR",
    "TARGET CORP.": "TGT",
    "TE CONNECTIVITY LTD": "TEL",
    "TESLA INC.": "TSLA",
    "TEXAS INSTRUMENTS INC.": "TXN",
    "TEXTRON INC": "TXT",
    "THERMO FISHER SCIENTIFIC INC": "TMO",
    "TJX COS.": "TJX",
    "TRANE TECHNOLOGIES PLC": "TT",
    "TRANSDIGM GROUP INC": "TDG",
    "TRAVELERS COS.": "TRV",
    "TRIMBLE INC": "TRMB",
    "TRUIST FINANCIAL CORP": "TFC",
    "TYLER TECHNOLOGIES": "TYL",
    "TYSON FOODS INC": "TSN",
    "UBER TECHNOLOGIES INC": "UBER",
    "UDR INC": "UDR",
    "ULTA BEAUTY INC": "ULTA",
    "UNION PACIFIC CORP.": "UNP",
    "UNITED AIRLINES HOLDINGS": "UAL",
    "UNITED PARCEL SERVICE INC": "UPS",
    "UNITED RENTALS INC": "URI",
    "UNITEDHEALTH GROUP INC": "UNH",
    "UNIVERSAL HEALTH SERVICES": "UHS",
    "UNUM GROUP ORD": "UNM",
    "US BANCORP ORD": "USB",
    "VALERO ENERGY CORP": "VLO",
    "VENTAS INC": "VTR",
    "VERISIGN INC": "VRSN",
    "VERISK ANALYTICS": "VRSK",
    "VERIZON COMMUNICATIONS": "VZ",
    "VERTEX PHARMACEUTICALS INC": "VRTX",
    "VF CORP.": "VFC",
    "VIATRIS INC": "VTRS",
    "VISA INC": "V",
    "VORNADO REALTY TRUST": "VNO",
    "VULCAN MATERIALS CO": "VMC",
    "WABTEC CORP": "WAB",
    "WALGREENS BOOTS ALLIANCE": "WBA",
    "WALMART INC.": "WMT",
    "WARNER BROS DISCOVERY INC": "WBD",
    "WASTE MANAGEMENT INC": "WM",
    "WATERS CORP": "WAT",
    "WELLTOWER INC": "WELL",
    "WELLS FARGO & CO.": "WFC",
    "WEST PHARMACEUTICAL SERVICES": "WST",
    "WESTERN DIGITAL CORP": "WDC",
    "WESTROCK CO": "WRK",
    "WEYERHAEUSER CO": "WY",
    "WHIRLPOOL CORP": "WHR",
    "WILLIAMS COS.": "WMB",
    "WYNN RESORTS LTD": "WYNN",
    "XCEL ENERGY INC": "XEL",
    "XYLEM INC": "XYL",
    "YUM! BRANDS INC": "YUM",
    "ZEBRA TECHNOLOGIES CORP": "ZBRA",
    "ZILLOW GROUP": "Z",
    "ZIMMER BIOMET HOLDINGS": "ZBH",
    "ZIONS BANCORPORATION": "ZION",
    "ZOOM VIDEO COMMUNICATIONS": "ZM",
    
    # International and additional variations
    "ACCENTURE": "ACN",
    "ADOBE SYSTEMS": "ADBE",
    "ADVANCED MICRO DEVICES INC": "AMD",
    "ALPHABET CLASS A": "GOOGL",
    "ALPHABET CLASS C": "GOOG",
    "AMAZON.COM INC.": "AMZN",
    "AMERICAN AIRLINES": "AAL",
    "AMERICAN AIRLINES GROUP": "AAL",
    "ANTHEM": "ELV",
    "APPLE COMPUTER": "AAPL",
    "APPLIED MATERIALS INC": "AMAT",
    "BOOKING.COM": "BKNG",
    "BRISTOL-MYERS SQUIBB CO": "BMY",
    "BROADCOM INC.": "AVGO",
    "CHARLES RIVER": "CRL",
    "CISCO SYSTEMS INC": "CSCO",
    "CONSTELLATION ENERGY CORP": "CEG",
    "CROWN CASTLE INTERNATIONAL": "CCI",
    "DANAHER CORP": "DHR",
    "DELL": "DELL",
    "DUPONT": "DD",
    "ELECTRONIC ARTS INC": "EA",
    "ELI LILLY & CO": "LLY",
    "EXXON": "XOM",
    "GENERAL ELECTRIC COMPANY": "GE",
    "GILEAD": "GILD",
    "GOOGLE INC": "GOOGL",
    "INTEL CORPORATION": "INTC",
    "JOHNSON CONTROLS": "JCI",
    "JPMORGAN": "JPM",
    "LINDE AG": "LIN",
    "LOCKHEED": "LMT",
    "MCDONALDS CORP": "MCD",
    "MERCK & CO.": "MRK",
    "MICROSOFT CORPORATION": "MSFT",
    "NETFLIX INC.": "NFLX",
    "NIKE INC.": "NKE",
    "NVIDIA CORPORATION": "NVDA",
    "ORACLE CORPORATION": "ORCL",
    "PEPSICO": "PEP",
    "PFIZER INC.": "PFE",
    "PROCTER & GAMBLE": "PG",
    "QUALCOMM INCORPORATED": "QCOM",
    "RAYTHEON TECHNOLOGIES": "RTX",
    "SALESFORCE INC.": "CRM",
    "STARBUCKS CORPORATION": "SBUX",
    "TESLA MOTORS": "TSLA",
    "TEXAS INSTRUMENTS INCORPORATED": "TXN",
    "THE WALT DISNEY COMPANY": "DIS",
    "UNITEDHEALTH": "UNH",
    "VERIZON COMMUNICATIONS INC": "VZ",
    "VISA INC.": "V",
    "WALMART INC": "WMT",
    "WELLS FARGO & COMPANY": "WFC",
}


def map_company_to_ticker(company_name: str) -> Optional[str]:
    """
    Map a company name to its ticker symbol.
    
    Parameters
    ----------
    company_name : str
        Company name from the quarterly earnings files
        
    Returns
    -------
    Optional[str]
        Ticker symbol, or None if no mapping found
        
    Examples
    --------
    >>> map_company_to_ticker("AMAZON.COM")
    'AMZN'
    >>> map_company_to_ticker("UNKNOWN COMPANY")
    None
    """
    if pd.isna(company_name):
        return None
    
    # Try exact match first
    ticker = COMPANY_TO_TICKER.get(company_name.upper().strip())
    if ticker:
        return ticker
    
    # Try partial matching for common variations
    company_upper = company_name.upper().strip()
    
    # Remove common suffixes
    for suffix in [" INC", " CORP", " CORPORATION", " LTD", " LIMITED", " PLC"]:
        if company_upper.endswith(suffix):
            base_name = company_upper[:-len(suffix)].strip()
            ticker = COMPANY_TO_TICKER.get(base_name)
            if ticker:
                return ticker
    
    return None


def add_ticker_column(earnings_df: pd.DataFrame, company_col: str = 'company_name') -> pd.DataFrame:
    """
    Add a ticker symbol column to an earnings DataFrame.
    
    Parameters
    ----------
    earnings_df : pd.DataFrame
        DataFrame with company names
    company_col : str
        Name of the column containing company names
        
    Returns
    -------
    pd.DataFrame
        DataFrame with added 'ticker' column
        
    Notes
    -----
    Rows without a ticker mapping will have NaN in the ticker column.
    """
    df = earnings_df.copy()
    df['ticker'] = df[company_col].apply(map_company_to_ticker)
    
    # Log mapping statistics
    total = len(df)
    mapped = df['ticker'].notna().sum()
    unmapped = total - mapped
    
    logger.info(f"Ticker mapping: {mapped:,} / {total:,} events mapped ({100*mapped/total:.1f}%)")
    if unmapped > 0:
        logger.info(f"  {unmapped:,} events without ticker mapping")
        
        # Show sample of unmapped companies
        unmapped_companies = df[df['ticker'].isna()][company_col].unique()[:10]
        if len(unmapped_companies) > 0:
            logger.info(f"  Sample unmapped companies: {list(unmapped_companies)[:5]}")
    
    return df
